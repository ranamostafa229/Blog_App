# Base image

FROM node:16

# Set the working directory

WORKDIR /app

# Install backend dependencies

COPY backend/package.json backend/package-lock.json ./
RUN npm install

# Copy backend files

COPY backend ./

# Build frontend

WORKDIR /app/frontend
COPY frontend/package.json frontend/package-lock.json ./
RUN npm install
COPY frontend ./
RUN npm run build

# Move build files to backend public directory

RUN mv /app/frontend/dist /app/backend/public

# Expose port and run the backend

WORKDIR /app/backend
EXPOSE 3000
CMD ["npm", "start"]
